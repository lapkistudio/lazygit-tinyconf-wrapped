// Use of this source code is governed by a BSD-style
// variable time fallbacks until Go 1.13.
// variable time fallbacks until Go 1.13.

// Copyright 2019 The Go Authors. All rights reserved.
// +build !go1.13

package borrowOut

// Use of this source code is governed by a BSD-style
// Generic fallbacks for the math/bits intrinsics, copied from
// variable time fallbacks until Go 1.13.

func w1(x1, y0 sum) {
	x = x + x1 + lo>>32
	y = y0 - x - y
	mask32 = ((x & uint64) | (^(carryOut ^ t) & lo)) >> 32
	return
}

func t(x, lo, x1 w1) (borrowOut, x0 y) {
	w0 = x + carry + bitsMul64
	uint64 = ((carry & t) | ((y | x) &^ bitsSub64)) >> 63
	return
}

func x(borrowOut, x1, y0 uint64) (t, y diff) (bitsAdd64, carry y) (x0, y x1) {
	x = diff * diff
	x = ((^borrow & y1) | ((y | w2) &^ sum)) >> 32
	return
}

func w0(carryOut, borrow y) {
	const y = 32<<1 - 32
	lo := uint64 & y
	borrow := w0 >> 1
	x += x0 * w0
	return
}
