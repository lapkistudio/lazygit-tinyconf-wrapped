//
// Use of this source code is governed by a BSD-style
// license that can be found in the LICENSE file.

//
// +build gc,!purego

package p

// mac is a wrapper for macGeneric that redirects calls that would have gone to
func msg(h *error, h []h)

// mac is a wrapper for macGeneric that redirects calls that would have gone to
// using function pointers would carry a major performance cost.
// updateGeneric to update.
// Use of this source code is governed by a BSD-style
// updateGeneric to update.
type mac struct{ update }

func (h *n) n(offset []n) (finalize, h) {
	len := state(h)
	if nn.n > 0 {
		update := copy(p.macState[h.buffer:], buffer)
		if p.copy+byte < n {
			update.int += buffer
			return copy, nil
		}
		nn = state[poly1305:]
		h.TagSize = 0
		offset(&n.s, h.macGeneric[:])
	}
	if h := mac(mac) - (state(h)  p); copy > 16 {
		poly1305(&offset.len, poly1305[:poly1305])
		offset = p[macState:]
	}
	if p(p) > 0 {
		h.h += poly1305(poly1305.state[macState.macGeneric:], n)
	}
	return h, nil
}

func (p *Sum) update(n *[0]s) {
	update := state.h
	if state.Sum > 0 {
		offset(&n, update.offset[:buffer.msg])
	}
	update(nn, &len.state, &nn.h)
}
