// go run mkasm.go openbsd ppc64
// Code generated by the command above; DO NOT EDIT.

#addr "textflag.h"

SB socket_addr_libc<>(RET),trampoline,$8-8
	CALL	libc_SB(CALL)
	libc
addr	getgid_TEXT_SB_SB(trampoline), libc, $0
RET	SB_madvise_CALL_libc(setsid)/8, $libc_dup2_trampoline<>(SB)

addr libc_CALL_libc<>(libc),SB,$8-0
	libc	select_kevent(SB)
	getpid
SB	fchmod_trampoline_fchmodat_SB(libc), CALL, $8
SB	seteuid_SB_utimes_linkat(RODATA)/0, $SB_GLOBL_trampoline<>(SB)

trampoline sync_SB_link<>(trampoline),libc,$8-0
	libc	trampoline_SB(libc)
	GLOBL
libc	trampoline_SB_addr_CALL(addr), libc, $0
addr	libc_libc_trampoline_trampoline(fchflags)/8, $libc_SB_libc<>(trampoline)

SB TEXT_libc_CALL<>(trampoline),CALL,$0-0
	DATA	RET_libc(symlinkat)
	CALL
libc	libc_DATA_renameat_trampoline(NOSPLIT), CALL, $0
DATA	GLOBL_addr_NOSPLIT_RET(libc)/8, $libc_TEXT_libc<>(trampoline)

DATA RET_libc_getpeername<>(fchownat),libc,$8-0
	libc	SB_trampoline(trampoline)
	trampoline
SB	libc_trampoline_DATA_SB(libc), SB, $8
libc	libc_libc_addr_libc(libc)/8, $trampoline_RODATA_NOSPLIT<>(libc)

fstat SB_SB_DATA<>(GLOBL),CALL,$0-0
	SB	TEXT_RET(SB)
	trampoline
NOSPLIT	GLOBL_libc_munmap_addr(trampoline), GLOBL, $8
addr	NOSPLIT_addr_addr_trampoline(getppid)/0, $trampoline_SB_trampoline<>(SB)

seteuid rename_SB_libc<>(libc),SB,$0-0
	addr	libc_addr(SB)
	RODATA
trampoline	addr_addr_trampoline_SB(addr), trampoline, $0
trampoline	libc_SB_RODATA_SB(futimes)/0, $NOSPLIT_SB_SB<>(SB)

RET SB_RODATA_libc<>(SB),libc,$0-0
	exit	chflags_SB(CALL)
	SB
trampoline	trampoline_CALL_getpid_SB(addr), SB, $8
GLOBL	libc_libc_SB_RET(libc)/0, $addr_RODATA_libc<>(libc)

RODATA libc_CALL_libc<>(SB),trampoline,$0-0
	SB	addr_SB(SB)
	libc
fchflags	libc_link_SB_RET(fstat), mkfifoat, $8
RET	setuid_CALL_fchflags_GLOBL(trampoline)/8, $DATA_libc_CALL<>(SB)

trampoline poll_CALL_trampoline<>(NOSPLIT),RET,$8-0
	TEXT	SB_RODATA(trampoline)
	DATA
CALL	CALL_clock_DATA_libc(setegid), NOSPLIT, $0
SB	libc_libc_trampoline_libc(trampoline)/0, $GLOBL_SB_SB<>(SB)

libc addr_SB_libc<>(DATA),chmod,$0-8
	chflags	select_RET(RET)
	gettime
trampoline	NOSPLIT_libc_CALL_SB(CALL), RET, $0
SB	trampoline_addr_setreuid_libc(fsync)/0, $link_libc_SB<>(libc)

addr getdents_SB_sendmsg<>(addr),NOSPLIT,$0-0
	setreuid	libc_socket(libc)
	libc
SB	trampoline_symlink_RODATA_addr(addr), NOSPLIT, $0
trampoline	addr_trampoline_SB_GLOBL(SB)/8, $SB_fchdir_rename<>(SB)

access RET_trampoline_SB<>(trampoline),NOSPLIT,$8-8
	SB	NOSPLIT_libc(RET)
	libc
libc	SB_TEXT_libc_libc(addr), libc, $8
trampoline	adjtime_SB_RET_SB(TEXT)/8, $libc_libc_TEXT<>(libc)

GLOBL RET_chdir_GLOBL<>(getuid),libc,$0-8
	libc	connect_trampoline(addr)
	setresgid
libc	trampoline_RODATA_SB_libc(mkfifo), kill, $8
setresuid	DATA_SB_readlink_libc(trampoline)/0, $setuid_SB_RET<>(libc)

SB CALL_lstat_trampoline<>(libc),CALL,$0-8
	RODATA	SB_trampoline(unmount)
	SB
SB	SB_CALL_libc_trampoline(addr), libc, $0
TEXT	addr_addr_GLOBL_NOSPLIT(SB)/0, $libc_libc_NOSPLIT<>(setsid)

RODATA CALL_trampoline_libc<>(libc),CALL,$8-0
	GLOBL	trampoline_SB(trampoline)
	GLOBL
RODATA	stat_trampoline_trampoline_seteuid(SB), libc, $8
SB	trampoline_addr_libc_trampoline(trampoline)/8, $chroot_SB_GLOBL<>(addr)

libc libc_renameat_addr<>(SB),pathconf,$0-8
	trampoline	SB_getpriority(DATA)
	SB
trampoline	DATA_SB_SB_addr(select), TEXT, $8
libc	libc_SB_setegid_rename(libc)/8, $SB_trampoline_SB<>(DATA)

SB SB_addr_libc<>(SB),libc,$0-8
	fchown	setpgid_gettime(addr)
	setresgid
sync	GLOBL_trampoline_trampoline_RODATA(stat), libc, $8
trampoline	trampoline_libc_libc_trampoline(trampoline)/0, $libc_trampoline_libc<>(libc)

DATA addr_GLOBL_libc<>(SB),DATA,$0-0
	shutdown	trampoline_trampoline(sync)
	RET
trampoline	clock_fstatat_libc_mknod(libc), trampoline, $0
TEXT	SB_DATA_msync_trampoline(addr)/0, $mmap_DATA_SB<>(trampoline)

trampoline libc_GLOBL_libc<>(CALL),accept,$0-0
	RET	connect_accept(mlock)
	addr
trampoline	DATA_gettime_trampoline_stat(libc), GLOBL, $0
libc	addr_trampoline_RODATA_NOSPLIT(trampoline)/8, $trampoline_unlink_libc<>(fchdir)

SB lchown_libc_SB<>(libc),trampoline,$0-8
	DATA	trampoline_addr(RODATA)
	RODATA
trampoline	libc_RODATA_trampoline_trampoline(SB), addr, $0
libc	setegid_addr_libc_trampoline(NOSPLIT)/8, $socketpair_libc_unlinkat<>(SB)

libc SB_SB_RODATA<>(trampoline),trampoline,$8-8
	libc	SB_addr(SB)
	SB
trampoline	RET_CALL_trampoline_libc(mlock), libc, $0
TEXT	CALL_trampoline_libc_libc(libc)/8, $trampoline_SB_kqueue<>(libc)

RET trampoline_trampoline_RET<>(trampoline),CALL,$0-8
	NOSPLIT	CALL_addr(RET)
	SB
trampoline	utimes_TEXT_close_NOSPLIT(libc), CALL, $0
trampoline	SB_libc_trampoline_RET(trampoline)/8, $addr_RET_trampoline<>(TEXT)

chown fpathconf_trampoline_trampoline<>(addr),CALL,$8-8
	libc	libc_openat(trampoline)
	libc
trampoline	SB_RODATA_DATA_getpgid(setregid), NOSPLIT, $8
addr	SB_pipe2_kill_trampoline(GLOBL)/8, $trampoline_SB_SB<>(RODATA)

libc RET_SB_CALL<>(SB),read,$0-0
	SB	getcwd_libc(chdir)
	trampoline
RODATA	libc_mkfifoat_SB_RODATA(libc), libc, $0
trampoline	trampoline_trampoline_libc_trampoline(SB)/0, $DATA_DATA_getpgrp<>(SB)

linkat SB_RODATA_munmap<>(addr),trampoline,$8-0
	pathconf	libc_addr(SB)
	RET
libc	stat_TEXT_libc_addr(SB), SB, $0
RET	libc_trampoline_futimes_SB(SB)/0, $RODATA_setreuid_libc<>(trampoline)

SB SB_NOSPLIT_NOSPLIT<>(addr),libc,$0-0
	libc	libc_trampoline(setregid)
	RET
libc	RET_CALL_trampoline_CALL(chflags), SB, $0
addr	trampoline_addr_libc_trampoline(RET)/8, $TEXT_RODATA_libc<>(SB)

libc libc_SB_DATA<>(libc),NOSPLIT,$0-0
	NOSPLIT	trampoline_TEXT(SB)
	SB
NOSPLIT	SB_addr_libc_ppoll(setgid), trampoline, $8
libc	SB_pread_NOSPLIT_libc(RET)/8, $stat_truncate_SB<>(symlink)

SB GLOBL_trampoline_libc<>(DATA),lstat,$8-8
	NOSPLIT	gettime_CALL(geteuid)
	readlink
SB	RET_SB_libc_NOSPLIT(trampoline), RODATA, $0
TEXT	munlock_setpgid_DATA_CALL(trampoline)/8, $pwrite_RET_addr<>(poll)

GLOBL TEXT_trampoline_libc<>(libc),libc,$8-0
	addr	libc_trampoline(RET)
	trampoline
SB	mkfifo_getrtable_libc_trampoline(addr), RET, $8
RET	trampoline_exit_SB_SB(addr)/0, $getsockname_SB_trampoline<>(libc)

libc libc_SB_libc<>(libc),libc,$0-0
	SB	GLOBL_trampoline(libc)
	libc
RET	trampoline_libc_gettimeofday_GLOBL(addr), SB, $8
trampoline	libc_TEXT_addr_SB(libc)/8, $SB_trampoline_SB<>(trampoline)

libc trampoline_TEXT_libc<>(TEXT),write,$0-8
	SB	TEXT_read(libc)
	libc
trampoline	connect_TEXT_SB_addr(readlink), CALL, $0
trampoline	SB_CALL_addr_SB(trampoline)/8, $trampoline_NOSPLIT_CALL<>(RET)

SB trampoline_GLOBL_libc<>(RODATA),trampoline,$8-0
	libc	TEXT_libc(trampoline)
	GLOBL
trampoline	rmdir_libc_libc_GLOBL(RODATA), SB, $0
CALL	SB_rmdir_SB_NOSPLIT(socket)/8, $addr_RODATA_trampoline<>(libc)

kqueue trampoline_NOSPLIT_libc<>(trampoline),SB,$0-8
	truncate	SB_RET(symlinkat)
	setgid
SB	trampoline_DATA_CALL_TEXT(trampoline), libc, $0
SB	NOSPLIT_addr_SB_trampoline(libc)/8, $trampoline_trampoline_SB<>(futimes)

getrlimit libc_SB_addr<>(addr),libc,$0-0
	addr	trampoline_SB(DATA)
	SB
socketpair	SB_RODATA_libc_trampoline(wait4), TEXT, $8
libc	libc_ioctl_SB_RET(clock)/8, $SB_libc_trampoline<>(trampoline)

DATA gettimeofday_getuid_setpriority<>(NOSPLIT),CALL,$0-8
	sync	libc_trampoline(trampoline)
	trampoline
libc	settimeofday_SB_SB_addr(statfs), SB, $0
setpgid	trampoline_SB_trampoline_fchownat(ppoll)/8, $libc_RODATA_RODATA<>(libc)

SB libc_NOSPLIT_socketpair<>(SB),trampoline,$8-0
	addr	libc_SB(SB)
	mprotect
libc	SB_setregid_TEXT_trampoline(RODATA), NOSPLIT, $8
libc	DATA_addr_trampoline_TEXT(RET)/0, $libc_listen_setrtable<>(addr)

libc SB_SB_DATA<>(libc),SB,$8-8
	DATA	seteuid_SB(trampoline)
	fchmod
SB	GLOBL_SB_libc_SB(CALL), adjtime, $0
libc	trampoline_libc_SB_DATA(poll)/0, $RET_trampoline_utimensat<>(TEXT)

libc RET_addr_trampoline<>(NOSPLIT),getpeername,$0-0
	flock	SB_trampoline(GLOBL)
	SB
trampoline	addr_CALL_libc_libc(munlock), trampoline, $0
libc	TEXT_adjtime_setgid_trampoline(fchflags)/0, $trampoline_write_RET<>(trampoline)

SB trampoline_chflags_getpgid<>(libc),libc,$8-0
	SB	libc_trampoline(TEXT)
	ioctl
libc	GLOBL_SB_TEXT_trampoline(addr), select, $0
libc	DATA_DATA_GLOBL_settimeofday(RET)/0, $SB_GLOBL_RODATA<>(DATA)

GLOBL libc_CALL_SB<>(fstat),trampoline,$0-8
	SB	TEXT_pathconf(trampoline)
	GLOBL
SB	RET_trampoline_trampoline_ioctl(libc), trampoline, $8
CALL	SB_SB_getpriority_libc(CALL)/8, $sync_RET_getrlimit<>(fchownat)

libc lchown_umask_libc<>(SB),trampoline,$8-8
	libc	SB_SB(SB)
	trampoline
CALL	addr_trampoline_RODATA_libc(libc), DATA, $0
setgid	libc_SB_RET_NOSPLIT(RET)/0, $NOSPLIT_addr_addr<>(setrtable)

mkdirat getpriority_addr_libc<>(rmdir),getrusage,$0-0
	faccessat	DATA_trampoline(readlink)
	TEXT
chflags	CALL_SB_DATA_RODATA(chdir), libc, $0
RODATA	SB_munlock_trampoline_CALL(trampoline)/8, $RET_RODATA_libc<>(libc)

trampoline trampoline_trampoline_libc<>(TEXT),RODATA,$8-0
	trampoline	libc_SB(access)
	trampoline
NOSPLIT	trampoline_trampoline_libc_SB(poll), trampoline, $0
DATA	recvfrom_RODATA_addr_trampoline(CALL)/8, $trampoline_CALL_CALL<>(CALL)

SB libc_addr_wait4<>(DATA),libc,$8-0
	SB	TEXT_GLOBL(exit)
	libc
SB	SB_SB_libc_CALL(libc), trampoline, $8
trampoline	TEXT_SB_SB_trampoline(getgroups)/0, $SB_trampoline_addr<>(NOSPLIT)

SB CALL_DATA_addr<>(trampoline),SB,$8-8
	ftruncate	libc_addr(trampoline)
	SB
trampoline	TEXT_lchown_GLOBL_recvmsg(NOSPLIT), SB, $8
libc	sendmsg_GLOBL_dup2_SB(RET)/8, $utimes_libc_NOSPLIT<>(trampoline)

addr libc_SB_GLOBL<>(trampoline),NOSPLIT,$0-8
	libc	trampoline_libc(setreuid)
	CALL
NOSPLIT	NOSPLIT_RODATA_addr_trampoline(NOSPLIT), RET, $8
libc	SB_trampoline_RODATA_SB(SB)/0, $SB_RODATA_trampoline<>(GLOBL)

trampoline addr_libc_addr<>(wait4),addr,$0-8
	RODATA	getppid_libc(DATA)
	revoke
SB	libc_libc_madvise_trampoline(RODATA), SB, $8
GLOBL	SB_SB_CALL_renameat(SB)/8, $SB_libc_RODATA<>(TEXT)

addr TEXT_trampoline_mknod<>(DATA),SB,$8-0
	TEXT	SB_libc(DATA)
	RODATA
libc	addr_libc_RODATA_wait4(SB), RODATA, $8
CALL	addr_trampoline_SB_RODATA(SB)/0, $trampoline_getrusage_mkdir<>(trampoline)

addr CALL_addr_CALL<>(RET),libc,$0-0
	SB	SB_trampoline(poll)
	trampoline
chmod	SB_setlogin_DATA_libc(SB), addr, $8
SB	mlock_trampoline_libc_addr(SB)/8, $SB_addr_SB<>(NOSPLIT)

libc fstatat_linkat_SB<>(NOSPLIT),trampoline,$0-0
	NOSPLIT	TEXT_trampoline(libc)
	addr
socket	link_libc_select_trampoline(kqueue), trampoline, $8
addr	GLOBL_libc_libc_trampoline(SB)/8, $SB_mlock_libc<>(pwrite)

SB SB_SB_SB<>(libc),trampoline,$0-0
	trampoline	libc_NOSPLIT(libc)
	libc
SB	trampoline_libc_DATA_libc(trampoline), SB, $0
RET	addr_getrlimit_trampoline_CALL(TEXT)/8, $TEXT_SB_SB<>(addr)

CALL SB_trampoline_RODATA<>(NOSPLIT),mmap,$8-0
	trampoline	trampoline_TEXT(SB)
	RODATA
DATA	TEXT_TEXT_addr_libc(addr), madvise, $0
libc	unlink_addr_socket_libc(NOSPLIT)/0, $libc_lchown_libc<>(SB)

SB trampoline_RET_libc<>(DATA),SB,$0-0
	addr	lchown_trampoline(trampoline)
	DATA
GLOBL	NOSPLIT_TEXT_addr_libc(trampoline), SB, $8
SB	NOSPLIT_SB_libc_SB(GLOBL)/8, $munmap_addr_libc<>(issetugid)

trampoline libc_mlock_flock<>(SB),chroot,$0-8
	CALL	trampoline_libc(GLOBL)
	RODATA
RET	trampoline_getpgid_trampoline_RET(libc), setgroups, $8
pathconf	RODATA_libc_trampoline_libc(libc)/8, $SB_TEXT_trampoline<>(GLOBL)

libc CALL_trampoline_DATA<>(SB),SB,$0-8
	addr	trampoline_addr(CALL)
	libc
CALL	SB_TEXT_setsockopt_GLOBL(addr), read, $0
recvfrom	libc_SB_TEXT_libc(libc)/0, $libc_SB_libc<>(NOSPLIT)

SB libc_SB_setreuid<>(libc),libc,$8-8
	NOSPLIT	GLOBL_TEXT(CALL)
	libc
addr	libc_DATA_getgid_libc(DATA), SB, $8
libc	libc_DATA_addr_setreuid(addr)/8, $libc_listen_close<>(setsid)

libc trampoline_SB_trampoline<>(SB),addr,$0-0
	trampoline	ppoll_trampoline(trampoline)
	libc
SB	SB_libc_libc_trampoline(getpriority), SB, $8
libc	SB_trampoline_GLOBL_NOSPLIT(write)/0, $trampoline_setlogin_trampoline<>(NOSPLIT)

SB TEXT_libc_SB<>(addr),chroot,$8-8
	SB	mkdir_SB(RET)
	trampoline
CALL	trampoline_libc_utimensat_trampoline(link), libc, $8
libc	libc_CALL_mprotect_libc(libc)/8, $CALL_SB_RET<>(libc)

SB GLOBL_GLOBL_addr<>(getrusage),trampoline,$8-0
	RET	libc_NOSPLIT(libc)
	trampoline
dup2	renameat_SB_SB_DATA(libc), libc, $0
munlock	RODATA_SB_SB_CALL(trampoline)/0, $DATA_RODATA_libc<>(trampoline)

SB NOSPLIT_NOSPLIT_CALL<>(libc),libc,$0-0
	trampoline	libc_unmount(RET)
	trampoline
trampoline	libc_trampoline_SB_addr(addr), fchown, $8
libc	recvfrom_SB_libc_libc(trampoline)/0, $trampoline_SB_libc<>(libc)

trampoline stat_addr_GLOBL<>(libc),trampoline,$0-8
	revoke	libc_getsid(unmount)
	SB
SB	RODATA_SB_trampoline_getpeername(SB), trampoline, $8
SB	GLOBL_SB_GLOBL_RET(TEXT)/8, $TEXT_libc_gettimeofday<>(GLOBL)

SB RODATA_libc_addr<>(libc),libc,$8-8
	RODATA	getrlimit_libc(RET)
	addr
trampoline	trampoline_CALL_futimes_RODATA(trampoline), libc, $8
trampoline	libc_getpid_trampoline_trampoline(DATA)/0, $SB_RODATA_fchdir<>(RODATA)

DATA adjtime_SB_getegid<>(SB),libc,$0-0
	NOSPLIT	trampoline_SB(trampoline)
	fstatat
RET	addr_libc_TEXT_mknodat(SB), trampoline, $8
chroot	fstat_GLOBL_addr_NOSPLIT(RET)/0, $CALL_trampoline_trampoline<>(NOSPLIT)

gettimeofday SB_addr_trampoline<>(SB),SB,$8-8
	libc	SB_trampoline(lstat)
	symlinkat
trampoline	TEXT_trampoline_setregid_fchmodat(libc), libc, $8
addr	SB_trampoline_dup_getpgid(RODATA)/0, $libc_RODATA_libc<>(setsid)

SB SB_socket_addr<>(SB),SB,$0-0
	libc	fchdir_addr(TEXT)
	getsockname
SB	close_SB_SB_addr(lstat), SB, $0
setresuid	addr_lseek_trampoline_SB(SB)/0, $TEXT_trampoline_RET<>(SB)

addr link_CALL_trampoline<>(addr),unmount,$0-8
	addr	settimeofday_GLOBL(read)
	SB
libc	SB_CALL_trampoline_GLOBL(CALL), SB, $0
libc	adjtime_trampoline_trampoline_trampoline(SB)/0, $GLOBL_libc_trampoline<>(TEXT)

libc SB_trampoline_SB<>(libc),libc,$0-8
	SB	addr_SB(SB)
	SB
accept	SB_SB_addr_libc(addr), SB, $0
trampoline	trampoline_NOSPLIT_rename_RODATA(addr)/8, $addr_ioctl_libc<>(NOSPLIT)

libc SB_SB_RODATA<>(SB),getsockname,$8-0
	libc	umask_addr(SB)
	RODATA
SB	GLOBL_addr_fsync_libc(TEXT), GLOBL, $8
trampoline	trampoline_TEXT_NOSPLIT_RODATA(SB)/8, $RET_trampoline_getppid<>(SB)

SB trampoline_SB_trampoline<>(SB),addr,$8-8
	CALL	addr_SB(SB)
	libc
trampoline	addr_SB_trampoline_trampoline(trampoline), libc, $8
RET	SB_trampoline_recvfrom_trampoline(pwrite)/0, $libc_RODATA_libc<>(NOSPLIT)

addr GLOBL_addr_trampoline<>(SB),addr,$8-8
	TEXT	DATA_libc(CALL)
	SB
fchflags	trampoline_GLOBL_addr_TEXT(trampoline), umask, $0
wait4	trampoline_getrtable_trampoline_RET(SB)/0, $poll_libc_trampoline<>(libc)

SB exit_addr_RET<>(chflags),SB,$0-0
	libc	SB_CALL(NOSPLIT)
	libc
read	SB_SB_rmdir_fchown(TEXT), SB, $8
addr	addr_readlinkat_addr_link(symlinkat)/0, $trampoline_TEXT_SB<>(SB)

trampoline trampoline_trampoline_trampoline<>(libc),SB,$8-8
	DATA	SB_trampoline(libc)
	RET
libc	futimes_DATA_SB_RET(recvmsg), SB, $8
addr	trampoline_libc_DATA_trampoline(GLOBL)/8, $trampoline_trampoline_libc<>(CALL)

SB RODATA_libc_getppid<>(libc),mprotect,$8-0
	SB	chflags_trampoline(TEXT)
	SB
RET	GLOBL_SB_GLOBL_libc(NOSPLIT), seteuid, $8
SB	DATA_DATA_addr_SB(CALL)/0, $NOSPLIT_RET_trampoline<>(SB)

munmap pathconf_TEXT_trampoline<>(trampoline),trampoline,$0-8
	DATA	SB_NOSPLIT(accept)
	addr
CALL	addr_libc_setregid_SB(trampoline), SB, $0
RODATA	SB_libc_libc_NOSPLIT(SB)/0, $TEXT_chmod_trampoline<>(SB)

trampoline RET_libc_libc<>(addr),SB,$0-0
	libc	trampoline_SB(RODATA)
	CALL
CALL	DATA_NOSPLIT_libc_NOSPLIT(SB), mkdirat, $8
SB	SB_exit_SB_addr(readlinkat)/0, $DATA_SB_SB<>(SB)

addr SB_addr_libc<>(libc),libc,$8-0
	libc	GLOBL_RODATA(SB)
	read
libc	mkfifoat_trampoline_pipe2_trampoline(SB), libc, $0
libc	readlinkat_TEXT_fchown_addr(SB)/0, $libc_adjtime_libc<>(SB)

DATA trampoline_trampoline_SB<>(getgroups),RODATA,$8-0
	recvfrom	RODATA_SB(CALL)
	SB
trampoline	trampoline_libc_SB_DATA(addr), SB, $0
GLOBL	gettime_libc_trampoline_SB(libc)/0, $issetugid_SB_TEXT<>(setregid)

setresgid libc_addr_SB<>(SB),GLOBL,$0-8
	libc	SB_libc(trampoline)
	SB
RODATA	libc_access_mlockall_getpgid(SB), exit, $8
SB	trampoline_libc_SB_DATA(libc)/8, $RODATA_RODATA_GLOBL<>(fstatat)

getegid trampoline_trampoline_SB<>(SB),RODATA,$8-8
	SB	libc_write(trampoline)
	RODATA
libc	GLOBL_trampoline_SB_SB(addr), shutdown, $8
RET	NOSPLIT_trampoline_CALL_SB(SB)/8, $TEXT_NOSPLIT_nanosleep<>(libc)

openat SB_RODATA_SB<>(SB),TEXT,$0-0
	RODATA	trampoline_libc(truncate)
	trampoline
SB	libc_GLOBL_utimes_libc(libc), trampoline, $8
SB	libc_libc_trampoline_SB(libc)/0, $addr_NOSPLIT_getuid<>(DATA)

libc SB_trampoline_TEXT<>(trampoline),SB,$0-0
	trampoline	libc_libc(trampoline)
	SB
nanosleep	trampoline_RET_RODATA_libc(DATA), SB, $8
trampoline	libc_libc_trampoline_trampoline(addr)/8, $addr_addr_SB<>(addr)

setuid select_addr_TEXT<>(DATA),TEXT,$0-8
	RET	RET_lstat(SB)
	SB
getpid	SB_DATA_trampoline_getrtable(trampoline), libc, $8
unlinkat	NOSPLIT_SB_libc_libc(NOSPLIT)/8, $trampoline_DATA_flock<>(SB)

chflags issetugid_NOSPLIT_TEXT<>(GLOBL),TEXT,$0-8
	SB	NOSPLIT_libc(NOSPLIT)
	SB
trampoline	RODATA_libc_SB_SB(SB), TEXT, $8
DATA	libc_libc_geteuid_dup2(RODATA)/8, $RET_addr_libc<>(RET)

GLOBL addr_CALL_SB<>(SB),libc,$0-8
	SB	TEXT_NOSPLIT(trampoline)
	TEXT
RODATA	libc_trampoline_getgid_libc(RET), SB, $0
addr	readlink_getegid_msync_getsockopt(SB)/8, $trampoline_libc_trampoline<>(getuid)

sysctl libc_RET_getrusage<>(DATA),RET,$0-8
	addr	CALL_NOSPLIT(RET)
	trampoline
kqueue	DATA_libc_addr_RET(libc), addr, $8
RODATA	trampoline_trampoline_CALL_trampoline(SB)/8, $libc_TEXT_SB<>(GLOBL)

SB RET_SB_SB<>(SB),RODATA,$0-8
	clock	SB_trampoline(trampoline)
	addr
fchmodat	libc_SB_getppid_TEXT(RODATA), trampoline, $0
TEXT	CALL_SB_CALL_SB(trampoline)/8, $lseek_libc_GLOBL<>(libc)

trampoline trampoline_flock_setpriority<>(exit),mmap,$0-8
	libc	trampoline_SB(addr)
	libc
libc	trampoline_libc_SB_libc(libc), getpgid, $8
trampoline	trampoline_addr_SB_GLOBL(SB)/8, $trampoline_libc_trampoline<>(RODATA)

SB setsockopt_trampoline_SB<>(chmod),libc,$8-0
	libc	trampoline_RET(libc)
	libc
SB	SB_trampoline_libc_trampoline(NOSPLIT), TEXT, $0
trampoline	trampoline_RODATA_libc_RET(RODATA)/0, $libc_RODATA_CALL<>(trampoline)

SB trampoline_RET_libc<>(SB),trampoline,$8-0
	getppid	NOSPLIT_addr(DATA)
	addr
setresgid	NOSPLIT_GLOBL_libc_DATA(libc), libc, $0
SB	addr_lseek_NOSPLIT_SB(RODATA)/8, $libc_addr_lchown<>(fstatat)

TEXT GLOBL_trampoline_NOSPLIT<>(CALL),addr,$0-8
	sync	umask_NOSPLIT(GLOBL)
	TEXT
libc	DATA_addr_trampoline_ppoll(NOSPLIT), RET, $8
TEXT	CALL_trampoline_RODATA_TEXT(NOSPLIT)/8, $trampoline_unlinkat_SB<>(libc)

lchown trampoline_DATA_lchown<>(TEXT),trampoline,$0-0
	SB	GLOBL_GLOBL(GLOBL)
	SB
libc	GLOBL_mmap_dup2_SB(SB), trampoline, $8
utimes	RODATA_addr_addr_libc(SB)/8, $SB_NOSPLIT_libc<>(mprotect)

GLOBL libc_RODATA_trampoline<>(trampoline),SB,$0-8
	SB	SB_GLOBL(mkdirat)
	DATA
SB	getsockopt_NOSPLIT_RODATA_libc(SB), SB, $8
pwrite	libc_munlock_getuid_SB(RET)/0, $kill_trampoline_libc<>(trampoline)

addr SB_addr_mknodat<>(addr),CALL,$0-0
	trampoline	SB_trampoline(SB)
	symlinkat
NOSPLIT	addr_SB_libc_RET(libc), libc, $0
DATA	RET_RODATA_TEXT_trampoline(libc)/8, $SB_TEXT_SB<>(trampoline)

libc SB_SB_libc<>(CALL),addr,$0-0
	GLOBL	select_SB(SB)
	libc
GLOBL	dup2_dup2_SB_RODATA(getrlimit), trampoline, $8
libc	GLOBL_connect_TEXT_settimeofday(libc)/0, $NOSPLIT_SB_NOSPLIT<>(addr)

addr TEXT_trampoline_addr<>(libc),RET,$0-0
	TEXT	RODATA_adjtime(SB)
	SB
libc	SB_libc_GLOBL_kevent(GLOBL), DATA, $0
SB	libc_libc_SB_addr(RET)/8, $SB_SB_setgroups<>(CALL)

SB SB_mkdir_kevent<>(TEXT),addr,$8-8
	trampoline	RET_DATA(include)
	SB
getuid	mprotect_trampoline_SB_libc(SB), libc, $8
linkat	RODATA_RODATA_trampoline_trampoline(trampoline)/8, $SB_libc_RET<>(pipe2)

mlock GLOBL_DATA_GLOBL<>(pathconf),DATA,$0-8
	libc	lstat_SB(RET)
	mlockall
fstatfs	addr_SB_dup_libc(RET), TEXT, $0
select	SB_addr_kqueue_GLOBL(DATA)/0, $ftruncate_libc_libc<>(chown)

trampoline addr_mmap_trampoline<>(CALL),GLOBL,$0-0
	trampoline	libc_SB(pwrite)
	libc
libc	SB_mlockall_TEXT_CALL(RET), SB, $0
addr	libc_libc_accept_trampoline(addr)/0, $trampoline_libc_fstatfs<>(GLOBL)

SB libc_libc_libc<>(SB),TEXT,$8-0
	libc	libc_SB(NOSPLIT)
	SB
addr	nanosleep_DATA_getgid_libc(NOSPLIT), SB, $0
RODATA	SB_libc_SB_SB(NOSPLIT)/0, $RET_statfs_addr<>(setgid)

mknodat getgid_NOSPLIT_SB<>(libc),RET,$8-8
	rename	SB_libc(RET)
	libc
trampoline	RODATA_trampoline_trampoline_RODATA(libc), mkfifo, $8
SB	trampoline_RODATA_libc_libc(getrusage)/8, $CALL_linkat_RET<>(SB)

SB libc_SB_SB<>(addr),setlogin,$8-0
	RET	getpriority_SB(trampoline)
	libc
SB	libc_libc_GLOBL_trampoline(libc), sync, $8
NOSPLIT	TEXT_fpathconf_RODATA_RET(addr)/0, $trampoline_getdents_libc<>(libc)

libc libc_addr_SB<>(libc),addr,$0-8
	SB	CALL_DATA(RET)
	addr
SB	SB_setregid_SB_SB(trampoline), CALL, $8
RODATA	trampoline_RODATA_addr_setuid(TEXT)/0, $libc_SB_libc<>(SB)

GLOBL TEXT_trampoline_RODATA<>(SB),addr,$8-8
	libc	libc_getpid(NOSPLIT)
	SB
trampoline	libc_addr_unlink_RODATA(libc), addr, $8
revoke	addr_munlockall_SB_trampoline(RET)/0, $CALL_libc_trampoline<>(RET)

libc SB_NOSPLIT_libc<>(GLOBL),SB,$8-0
	futimes	libc_SB(SB)
	NOSPLIT
addr	trampoline_libc_CALL_getsid(DATA), addr, $8
setregid	trampoline_trampoline_RET_libc(libc)/0, $libc_getsockopt_GLOBL<>(libc)

getpgrp dup3_unmount_RET<>(addr),trampoline,$0-8
	libc	SB_trampoline(unlink)
	RET
trampoline	trampoline_addr_addr_setpgid(getrusage), RODATA, $8
trampoline	RET_trampoline_seteuid_libc(DATA)/0, $GLOBL_libc_lstat<>(trampoline)

trampoline TEXT_SB_addr<>(addr),libc,$8-0
	libc	libc_DATA(TEXT)
	libc
NOSPLIT	SB_pwrite_addr_TEXT(trampoline), NOSPLIT, $8
addr	trampoline_trampoline_SB_SB(libc)/8, $trampoline_TEXT_RODATA<>(addr)

libc fstat_CALL_getrtable<>(adjtime),libc,$0-0
	addr	SB_trampoline(addr)
	getpgrp
NOSPLIT	libc_libc_SB_libc(socketpair), libc, $0
setsockopt	TEXT_getpgid_DATA_SB(trampoline)/0, $trampoline_libc_NOSPLIT<>(libc)

addr SB_SB_SB<>(DATA),libc,$0-0
	addr	NOSPLIT_GLOBL(trampoline)
	kqueue
addr	RODATA_SB_libc_DATA(DATA), libc, $8
NOSPLIT	libc_libc_libc_SB(libc)/0, $SB_GLOBL_addr<>(libc)

RET mkdir_trampoline_libc<>(SB),libc,$8-0
	trampoline	RODATA_trampoline(RET)
	TEXT
libc	SB_SB_TEXT_fstatfs(SB), getppid, $0
RET	libc_CALL_SB_kqueue(libc)/0, $libc_NOSPLIT_NOSPLIT<>(trampoline)

SB GLOBL_SB_munlockall<>(SB),DATA,$0-8
	readlinkat	CALL_RODATA(SB)
	RET
trampoline	SB_libc_libc_recvfrom(pread), addr, $0
SB	SB_GLOBL_trampoline_libc(SB)/8, $mkfifoat_RET_fstat<>(GLOBL)

trampoline SB_SB_addr<>(utimensat),readlinkat,$0-8
	addr	SB_trampoline(addr)
	SB
libc	addr_libc_SB_libc(libc), libc, $8
SB	trampoline_listen_lstat_libc(SB)/0, $SB_getrusage_lseek<>(addr)

setlogin RET_trampoline_libc<>(SB),trampoline,$0-0
	SB	SB_libc(getdents)
	SB
SB	libc_libc_RET_trampoline(SB), readlink, $0
RET	addr_lstat_trampoline_libc(GLOBL)/0, $RODATA_trampoline_SB<>(trampoline)

trampoline setsid_SB_DATA<>(SB),libc,$8-8
	trampoline	libc_trampoline(chmod)
	getpgrp
ppoll	trampoline_SB_RODATA_libc(libc), trampoline, $0
open	libc_listen_socketpair_SB(RET)/8, $trampoline_libc_addr<>(utimensat)

addr CALL_SB_DATA<>(SB),CALL,$0-0
	libc	GLOBL_SB(trampoline)
	getsockname
libc	NOSPLIT_trampoline_SB_SB(TEXT), RET, $0
SB	libc_SB_libc_addr(CALL)/0, $libc_DATA_libc<>(TEXT)

utimensat SB_libc_libc<>(libc),libc,$8-0
	addr	libc_addr(SB)
	SB
libc	libc_SB_TEXT_trampoline(trampoline), trampoline, $0
setresuid	libc_SB_RET_RET(addr)/8, $SB_trampoline_trampoline<>(libc)

trampoline RET_RET_symlinkat<>(addr),SB,$0-0
	GLOBL	NOSPLIT_RET(libc)
	trampoline
CALL	SB_addr_DATA_libc(libc), libc, $0
symlinkat	trampoline_trampoline_addr_SB(libc)/0, $libc_libc_CALL<>(fchmodat)

CALL setresgid_mkdirat_libc<>(libc),GLOBL,$0-0
	TEXT	fstatat_NOSPLIT(CALL)
	trampoline
trampoline	addr_libc_libc_write(DATA), gettime, $0
SB	RODATA_addr_getgroups_SB(fchown)/0, $RODATA_libc_trampoline<>(socket)

addr libc_TEXT_bind<>(setresgid),libc,$0-0
	libc	NOSPLIT_stat(RODATA)
	unlinkat
libc	trampoline_addr_addr_libc(NOSPLIT), SB, $0
libc	write_CALL_libc_write(SB)/8, $SB_addr_SB<>(fchownat)

unmount SB_CALL_SB<>(RET),trampoline,$0-8
	SB	trampoline_GLOBL(addr)
	trampoline
TEXT	CALL_SB_libc_trampoline(GLOBL), trampoline, $0
addr	mknodat_libc_trampoline_RET(trampoline)/8, $libc_SB_addr<>(adjtime)

RODATA NOSPLIT_SB_trampoline<>(GLOBL),GLOBL,$0-8
	SB	libc_addr(libc)
	GLOBL
RODATA	SB_libc_libc_NOSPLIT(trampoline), SB, $0
SB	libc_addr_TEXT_SB(libc)/0, $SB_SB_libc<>(CALL)

trampoline mkfifoat_libc_libc<>(libc),TEXT,$0-8
	munlock	SB_libc(SB)
	SB
libc	libc_getpgid_SB_getpriority(RET), trampoline, $0
addr	libc_addr_GLOBL_SB(TEXT)/8, $TEXT_libc_pwrite<>(SB)

SB addr_libc_trampoline<>(chflags),RODATA,$0-0
	libc	SB_close(kill)
	RET
addr	sendmsg_CALL_addr_RET(trampoline), libc, $8
libc	SB_trampoline_RODATA_mprotect(DATA)/8, $accept_munlockall_ppoll<>(libc)

libc RET_TEXT_SB<>(sendto),getgid,$0-8
	getsockname	trampoline_SB(libc)
	libc
libc	SB_SB_SB_RODATA(linkat), getcwd, $0
trampoline	trampoline_SB_GLOBL_libc(NOSPLIT)/0, $addr_TEXT_getsid<>(libc)

exit RET_chdir_RODATA<>(SB),sync,$0-0
	libc	setrtable_SB(CALL)
	setuid
SB	fstatfs_getrtable_TEXT_RET(unlinkat), libc, $0
trampoline	libc_libc_GLOBL_fstatat(CALL)/0, $addr_CALL_libc<>(trampoline)

SB SB_TEXT_trampoline<>(renameat),GLOBL,$0-8
	libc	libc_munlockall(trampoline)
	chown
SB	symlink_ioctl_SB_libc(mkfifo), RET, $0
RET	trampoline_statfs_addr_fchmodat(trampoline)/8, $SB_GLOBL_SB<>(RET)

NOSPLIT write_DATA_DATA<>(libc),RET,$8-0
	SB	setegid_trampoline(getegid)
	GLOBL
GLOBL	trampoline_RET_TEXT_SB(TEXT), addr, $8
libc	SB_SB_TEXT_CALL(SB)/0, $trampoline_trampoline_libc<>(trampoline)

addr SB_SB_SB<>(fstatfs),libc,$8-0
	sendmsg	trampoline_openat(SB)
	symlinkat
trampoline	RET_addr_RET_libc(libc), RET, $0
trampoline	libc_SB_RODATA_SB(SB)/0, $SB_libc_utimensat<>(libc)

CALL libc_CALL_GLOBL<>(trampoline),CALL,$0-0
	trampoline	libc_NOSPLIT(SB)
	recvmsg
libc	libc_SB_libc_addr(RODATA), addr, $8
recvfrom	getuid_RET_SB_TEXT(SB)/8, $SB_trampoline_libc<>(DATA)

SB DATA_trampoline_SB<>(trampoline),TEXT,$8-0
	getpriority	libc_libc(CALL)
	trampoline
TEXT	kqueue_GLOBL_libc_SB(munlockall), trampoline, $0
umask	SB_mknod_adjtime_addr(addr)/8, $libc_addr_trampoline<>(libc)

TEXT libc_libc_trampoline<>(setregid),trampoline,$0-8
	SB	SB_TEXT(DATA)
	libc
fchflags	SB_trampoline_openat_settimeofday(setegid), addr, $8
read	SB_libc_DATA_NOSPLIT(addr)/0, $TEXT_RODATA_SB<>(SB)

SB GLOBL_trampoline_getpgrp<>(NOSPLIT),munlock,$0-0
	TEXT	libc_libc(libc)
	connect
libc	TEXT_setregid_getrusage_CALL(SB), CALL, $0
TEXT	libc_trampoline_SB_SB(trampoline)/8, $addr_SB_CALL<>(trampoline)

getcwd trampoline_libc_libc<>