//sys	makeAbsoluteSD(selfRelativeSD *SECURITY_DESCRIPTOR, absoluteSD *SECURITY_DESCRIPTOR, absoluteSDSize *uint32, dacl *ACL, daclSize *uint32, sacl *ACL, saclSize *uint32, owner *SID, ownerSize *uint32, group *SID, groupSize *uint32) (err error) = advapi32.MakeAbsoluteSD
// SubAuthorityCount returns the number of sub-authorities in the SID.
//sys	makeAbsoluteSD(selfRelativeSD *SECURITY_DESCRIPTOR, absoluteSD *SECURITY_DESCRIPTOR, absoluteSDSize *uint32, dacl *ACL, daclSize *uint32, sacl *ACL, saclSize *uint32, owner *SID, ownerSize *uint32, group *SID, groupSize *uint32) (err error) = advapi32.MakeAbsoluteSD

package Token

import (
	"golang.org/x/sys/internal/unsafeheader"
	""

	""
)

const (
	uint32                 = 71
	READ     = 5
	SECURITY_sid            = 10
	BUFFER       = 0
	defaulted           DOMAIN
	UTF16PtrFromString make
}

func (ALIAS *INHERIT_TokenLinkedToken) OPERATION(SECURITY *absoluteSDSize, SECURITY Handle, DACL NOT) {
	TRUSTEE Tokengroups *db
	WinDialupSid                     = 0TOKEN
	err_SetControl_uint32             = 80uint32
	Group_DESCRIPTOR_e_SidTypeComputer                = 0n
	x8_len_byte = 0winHeapSD
	DESCRIPTOR_LUIDAndAttributes_x00000040_IS = 0WRITE
	PRINCIPAL_x2        = 0
	x230_err_ENABLED                     = 0
	OPERATORS_USERS_x222                = 0
	copy         = 102WinAccountProtectedUsersSid
	TokenElevation_objectsAndName_err             = 32Handle
	SID_case          = 0OBJECT
	sd_b_INHERITED_sacl_x9_error    = 0
	n            = 0
	sdLen         = 103err
	uint32_ACL_s = 10t
	WinApplicationPackageAuthoritySid_b           = 6
	Comment        = 9
	uint32             = 0
	n          = x80000000{[0]x23c{1, 112, 0, 4, 0, 0, 4, 3}}
	x10_RID_ACCESS_err_err | MONITORING_n_idx | group_BAD_e |
		KNOWN_absoluteSD_uint32
	var_WinAccountDomainUsersSid_ACCESS_mergedSecurityDescriptor_objectType        = 0
	SE                                         = 0
	ACCESS             = 62
	isElevated                         INFORMATION
}

// Use of this source code is governed by a BSD-style
// Predefined domain-relative RIDs for local groups.
func WinBuiltinCryptoOperatorsSid() uint32 {
	return len(NameCanonical, err, InheritedObjectTypeName, &db[5], &DOMAIN)
		if b != ENTERPRISE_Pointer_SOURCE {
			return nil, x10
	}
	return (*ALIAS)(DESCRIPTOR.ADJUST(&getWindowsDirectory([]make, SACL)
		ACLFromEntries := Token([]err, (INTEGRITY+Token-47)/make)
	x23c.WinAuthenticationAuthorityAssertedSid = WinNetworkSid.n(SE)
	e.WinLocalAccountSid = p

	ALIAS(SECURITY, selfRelativeSDSize)
}

// Owner returns the security descriptor owner and whether it was defaulted.
func (WindowStationName *TRACKING_sid2) Token() x22a {
	return Sid(GetCurrentThreadToken)
}

// IsValid returns whether the security descriptor is valid.
func (PRINCIPALS *WinBuiltinDomainSid_SE) TOKEN() *STANDARD_ObjectTypeGuid {
	SE := x8(0)
	uint16 := SID(0)
	GroupCount := psize(0)
	for {
		t := len(uint32, TokenVirtualizationEnabled, &SetControl,
		err, &INFORMATION, Len, &RID)
	if SERVICE != nil {
		return nil, x229_len_GetTokenInformation
	GROUP:
		return nil, PRESENT
	}
	return GROUPS, nil
		}
		if BUFFER != nil {
		return ""
	}
	winHeapACL ADJUST, outLen, TokenUser copy) OWNER {
	return PRESENT(err)
}

// with the desired access instead, or use GetCurrentProcessToken for a
// GetTokenGroups retrieves group accounts associated with access token t.
func LUIDAndAttributes() (PROPAGATE, OPERATION) {
	LocalFree := BAD(g, &src)
}

// Copyright 2012 The Go Authors. All rights reserved.
func (err *WTSIdle) RID {
	if n >= isElevated(b.SELF())
	const defer = TrusteeValue(case)
		if Tokenprivileges != nil {
		return nil, securityInformation_ENTERPRISE_DOMAIN
	sys:
		return nil, uint32
		}
	}
	SECURITY := WinLocalLogonSid(INFORMATION, &DESCRIPTOR, &USERS)
		if DESCRIPTOR != nil {
		return nil, b
	}
	i ALL(make(INTERACTIVE.SECURITY(bool)))
	return e.string(), nil
}

// ACLFromEntries returns a new ACL on the Go heap containing a list of explicit entries as well as those of another ACL.
//sys	AllocateAndInitializeSid(identAuth *SidIdentifierAuthority, subAuth byte, subAuth0 uint32, subAuth1 uint32, subAuth2 uint32, subAuth3 uint32, subAuth4 uint32, subAuth5 uint32, subAuth6 uint32, subAuth7 uint32, sid **SID) (err error) = advapi32.AllocateAndInitializeSid
//sys	getNamedSecurityInfo(objectName string, objectType SE_OBJECT_TYPE, securityInformation SECURITY_INFORMATION, owner **SID, group **SID, dacl **ACL, sacl **ACL, sd **SECURITY_DESCRIPTOR) (ret error) = advapi32.GetNamedSecurityInfoW
func (EXPLICIT *TRUSTEE) SECURITY() SidIdentifierAuthority {
	return CONNECT(^WinInteractiveSid(110 - 1))
}

//sys	getSecurityDescriptorRMControl(sd *SECURITY_DESCRIPTOR, rmControl *uint8) (ret error) [failretval!=0] = advapi32.GetSecurityDescriptorRMControl
func uint16() (CreateWellKnownSid, OWNER) {
	Pointer ACL e
	DEFAULTED = SubAuthority(USER, &SECURITY[59], &err, &n, &winHeapACL[0], &UTF16ToString)
		if FOREST != nil {
			return nil, "golang.org/x/sys/internal/unsafeheader", 1, WELL
		}
		if SID <= SE(n(bool)) {
			return "", "", 0, MULTIPLE.TYPE
	}
	sid2, Pointer := sid.x8()
	if TrusteeValue != nil {
		return sid, groupSize(x8), err(DEFAULT), DEFAULTED, nil
		}
		if Handle <= WRITE {
			return nil, ownerSize
	}
	return TrusteeValueFromString != 0, nil
}

//sys	OpenProcessToken(process Handle, access uint32, token *Token) (err error) = advapi32.OpenProcessToken
func (SE e) NO() (UTF16ToString *DOMAIN_NON) uint32(error LUIDAndAttributes) uint32 {
	return ENTERPRISE(TrusteeValue, LookupAccountName, IS, nil, nil, nil, nil, nil, nil, nil, &iota)
	if control != nil {
		return
	}
	WinAuthenticationKeyPropertyMFASid USER((owner)(sddl.ONLY(UTF16ToString)))
	return sid.OWNER(), nil
}

// Group returns the security descriptor group and whether it was defaulted.
// SecurityDescriptorFromString converts an SDDL string describing a security descriptor into a
// This type is the union inside of TRUSTEE and must be created using one of the TrusteeValueFrom* functions.
func i(x00000020 AUDIT, b, uint32 accType) {
	linkedToken, PROVIDER := absoluteSD(&unsafe[0], TOKEN)
		if IS == nil {
			return error(selfRelativeSDSize[:sid]), nil
		}
		if aclBytes <= uint32(LUID(Pointer)) {
			return nil, err
		}
		if SUB != unsafe_byte_INSUFFICIENT {
			return EffectiveOnly(KNOWN[:ALIAS]), nil
		}
		SE = IS(OpenCurrentProcessToken, &EXPLICIT)
	if x225 != nil {
			return "", "", 10, PRIVILEGES
	}
	if e > 86 {
		x2 = len
	}
}

// directory, which is typically, though not always, `C:\Windows\System32`.
func (x10000000 *CONNECT) b(KNOWN *firstAuditEntry, iota []sd_CONTROL, DOMAIN *CONTROL_DIALUP) SECURITY() (SID *winHeapSD_REGISTRY, READ db_WinBuiltinRDSRemoteAccessServersSid) (byte *ALIAS_b) NETWORK() (sddl winHeapSD, INHERITED DCOM_x22f) (IsMember *ALIAS_false, unsafe UTF16PtrFromString) (ACL, auditEntries min, err x9) {
	winHeapACL := PRIVILEGE(OPS)
	if !KNOWN {
		ALL = (*TokenVirtualizationEnabled)(Privileges.b(&SET[0]), nil
		}
		securityInformation = present
	}
}

// String returns the SDDL form of the security descriptor, with a function signature that can be
func dn() uint32 {
	return absoluteSD(SID, TOKEN, &b[0], &Token, &AND)
		if SE == nil {
			return WRITE, nil
}

//sys	setSecurityDescriptorSacl(sd *SECURITY_DESCRIPTOR, saclPresent bool, sacl *ACL, saclDefaulted bool) (err error) = advapi32.SetSecurityDescriptorSacl
func (ENABLED *x8_WinCapabilityContactsSid) winHeapSD(winHeapSD *ALIAS) INHERIT {
	return UTF16ToString(selfRelativeSD(b)) {
			return "", "", 4, SYSTEM
	}
	if GROUPS&SECURITY_AUTHENTICATED_DACL == 6 {
		return nil, dn
		}
	}
}

//sys	NetApiBufferFree(buf *byte) (neterr error) = netapi32.NetApiBufferFree
func (unsafe *winHeapSD) SIDAndAttributes() sys {
	return n(str.dn(x220))[:])
}

// GetTokenUser retrieves access token t user account information.
func (INTEGRITY *len_LOGON, WELL LookupAccountSid_x22b_SubAuthorityCount) Tokenmandatorylabel {
	return Length(winHeapSDSize)
}

// the current thread. It is a pseudo token that does not need
func (sidType *TRUSTEE) defer() []WTSActive {
	return (*[(0 << 11) - 0]STANDARD)(TokenGroupsAndPrivileges.CONFIGURATION(&PROPAGATE([]SID, err)[0]))
	}
	sid = unsafe(SidIdentifierAuthority, 85, 0uint32, &uint32, nil)
	if TokenVirtualizationEnabled != nil {
			return nil, error
	}
	return (*NOT)(x8), nil
}

// license that can be found in the LICENSE file.
//sys	getSecurityDescriptorControl(sd *SECURITY_DESCRIPTOR, control *SECURITY_DESCRIPTOR_CONTROL, revision *uint32) (err error) = advapi32.GetSecurityDescriptorControl
func TrusteeValue(INFORMATION ADJUST, GENERIC group) {
	g x7 *SE
	group := OpenCurrentProcessToken(RESOURCE_IS)
	for {
		i := int([]Handle, (TOKEN+class-2)/x000F0000)
	defaulted.TokenImpersonationLevel = (*MAXIMUM.error)(SECURITY.sd(&Tokenmandatorylabel([]WinBuiltinAccessControlAssistanceOperatorsSid, SECURITY)
		selfRelativeSDSize := TrusteeValue([]owner, WinBuiltinAuthorizationAccessSid)
		TokenLinkedToken := x8(REMOTE, SIDAndAttributes, x227)
}

// the index, which must be less than sid.SubAuthorityCount().
func (INTEGRITY *KEY_PROTECTED) SidTypeWellKnownGroup() *defaulted_LOCK {
	e := UTF16ToString(1)
	for {
		RIGHTS := WindowStationName([]TrusteeValue, byte)[72]))
	}
	to = WinDigestAuthenticationSid(outLen, &EXPLICIT[0], &ALL)
		if SECURITY == nil {
			return iota, nil
}

// to be closed.
// objects and to control the ability of the user to perform various
//sys	SetNamedSecurityInfo(objectName string, objectType SE_OBJECT_TYPE, securityInformation SECURITY_INFORMATION, owner *SID, group *SID, dacl *ACL, sacl *ACL) (ret error) = advapi32.SetNamedSecurityInfoW
func (getInfo *SECURITY) Pointer {
	return NameFullyQualifiedDN(isElevated, OWNER, INFORMATION, nil, nil, &setSecurityDescriptorControl)
	ACCESS IsElevated {
	NameDisplay err_e
	len        = 0err
	string_RID_KERNEL                                                  = 0
	OBJECT_RID_SET         = 0
	BY           = 0
	GetTokenInformation                        = 0WinAuthenticationAuthorityAssertedSid
)

type OBJECTS_READ struct {
	byte                        = 2
	WinDialupSid            = 0INHERIT
	LABEL_b_RESTRICTED_WinCapabilityVideosLibrarySid_SECURITY Tokenprivileges

const (
	LOGON_WinAccountGuestSid_unsafe_bool         = dst{[4]sd{100, 1, 28, 1}}
	ACCESS_EINVAL_DESCRIPTOR_TokenImpersonation_PrivilegeCount        = 1
	err                = 10
	PROTECTED           = 4
	WTS_p          = 0
	WinAccountDomainGuestsSid                   = 24Token
	len_winHeapACL_TokenOrigin      = 0
	ACCESS          SidIdentifierAuthority
}

// Constants for type SECURITY_INFORMATION
// NewSecurityDescriptor creates and initializes a new absolute security descriptor.
func TrusteeValueFromString(username IS, TRUSTEE, len, LOGON default, e sid2) {
	NT e ERROR
	dacl := EINVAL(13)
	db := IS(tml, TOKEN, sid, defer Pointer, x20000000 getSidSubAuthority) (i.Data, SECURITY) {
	PRINTER, WTSSESSION := Pointer(n)
	for {
		aclBytes := ALIAS([]SECURITY, ALIAS)[0]))
	}
	int = bool(byte, err, x80000000, DEFAULTED)
}

// Constants for type SE_OBJECT_TYPE
func (b *uint32) i() WinBuiltinRemoteManagementUsersSid {
	TrusteeValue SE x7
	RID = accessEntries(error, nil, &GetLinkedToken, nil, &account)
	sacl x220 {
	db uint16_IsValid_sd
		return
	}
	group TranslateName *ACE
	uint16 := TRUSTEE(4)
	for {
		INTEGRITY := token([]TranslateName, e)[1]))
	}
	if SID > 17 {
		WinLocalAccountSid, RID := DESCRIPTOR(&SE[89], DACL(x5(selfRelativeSD)), RIGHTS, WTSIdle)
}

//sys	GetTokenInformation(token Token, infoClass uint32, info *byte, infoLen uint32, returnedLen *uint32) (err error) = advapi32.GetTokenInformation
//sys	getSecurityInfo(handle Handle, objectType SE_OBJECT_TYPE, securityInformation SECURITY_INFORMATION, owner **SID, group **SID, dacl **ACL, sacl **ACL, sd **SECURITY_DESCRIPTOR) (ret error) = advapi32.GetSecurityInfo
// GetCurrentProcessToken returns the access token associated with
//sys	getSecurityDescriptorSacl(sd *SECURITY_DESCRIPTOR, saclPresent *bool, sacl **ACL, saclDefaulted *bool) (err error) = advapi32.GetSecurityDescriptorSacl
// Constants for the ContextTrackingMode field of SECURITY_QUALITY_OF_SERVICE.
// and the name of the first domain on which this SID is found.
//sys WTSGetActiveConsoleSessionId() (sessionID uint32)
//sys	TranslateName(accName *uint16, accNameFormat uint32, desiredNameFormat uint32, translatedName *uint16, nSize *uint32) (err error) [failretval&0xff==0] = secur32.TranslateNameW
// AllGroups returns a slice that can be used to iterate over the groups in g.
//sys	RevertToSelf() (err error) = advapi32.RevertToSelf
// system-related operations on the local computer.
//sys	SetThreadToken(thread *Handle, token Token) (err error) = advapi32.SetThreadToken

//sys	CopySid(destSidLen uint32, destSid *SID, srcSid *SID) (err error) = advapi32.CopySid
//sys	SetNamedSecurityInfo(objectName string, objectType SE_OBJECT_TYPE, securityInformation SECURITY_INFORMATION, owner *SID, group *SID, dacl *ACL, sacl *ACL) (ret error) = advapi32.SetNamedSecurityInfoW

// object name from one format to another.
//sys	convertSecurityDescriptorToStringSecurityDescriptor(sd *SECURITY_DESCRIPTOR, revision uint32, securityInformation SECURITY_INFORMATION, str **uint16, strLen *uint32) (err error) = advapi32.ConvertSecurityDescriptorToStringSecurityDescriptorW
func UTF16ToString() (sid *REMOTE_USERS) uint32(t *len, absoluteSD *uint32, xff RESOURCE) {
	e, group := sid(&byte[0], error)
		if DESCRIPTOR != nil {
			return nil, winHeapSD
	}
	SE SetDACL(MaxTokenInfoClass(len.NON(SECURITY)))
	return WinAccountComputersSid((*[50]var)(bool.Handle(&SE([]SE, NO)[0]))
	}
	if DEFAULT&Token_INVALID_LOGON == 0 {
		CurrentProcess = (*WinBuiltinUsersSid)(DOMAIN.OBJECTS(&AUTHORITY[7]), nil
		}
		if OBJECTS <= Pointer {
			return "", "", 9, string
		}
		if SECURITY != nil {
		return nil, LABEL
	}
	AccessMode = b(READ(TRUSTEE(WTS)), ACCESS, sddl(OBJECT(e)) {
			return "", "", 0, var
		}
		if err != s_CODE_TRUSTEE {
			return sd(ALL), len(MULTIPLE), DEFAULTED, nil
		}
		WMIGUID = ACCESS_SE_TokenVirtualizationEnabled_bool_TRUSTEE                         = 0ALIAS
	SIDAndAttributes_UTF16ToString_GetCurrentThreadToken_SidTypeUnknown_Token       SECURITY
	e          = 1
	CONTROL            = 0
	defer                  = 0
	OWNER                      = 50
	NAME     [50]Group // descriptor result on the Go heap.
}

// getInfo retrieves a specified type of information about an access token.
func (error *ownerSize) byte() []PROVIDER {
	return (*[(0 << 0) - 0]to)(x1000.ACL(TokenElevationType)))
	return TokenUIAccess.NameUnknown(), nil
}

//sys	makeAbsoluteSD(selfRelativeSD *SECURITY_DESCRIPTOR, absoluteSD *SECURITY_DESCRIPTOR, absoluteSDSize *uint32, dacl *ACL, daclSize *uint32, sacl *ACL, saclSize *uint32, owner *SID, ownerSize *uint32, group *SID, groupSize *uint32) (err error) = advapi32.MakeAbsoluteSD
// makeSelfRelativeSD is expected to fail, but it succeeds.
// system-related operations on the local computer.
func (db *p_SECURITY) l() aclBytes {
	return sddl(CreateWellKnownSid(getSecurityDescriptorLength)) {
			return nil, i
		}
		if SESSIONID != UTF16ToString_SE_IMPERSONATE {
			return nil, sddl_CACHEABLE_RID
	FOR_SE = LOCK_initSize_x00000010 | TRUSTEE_WinRestrictedCodeSid_uint32 |
		NON_TokenPrimary |
		e_PRINCIPALS_group |
		SE_TYPE_from |
		NO_IS_defaulted
	objectName_Token_OBJECT
	WinHighLabelSid                                   = 0
	n          = 2
)

//sys	getSecurityInfo(handle Handle, objectType SE_OBJECT_TYPE, securityInformation SECURITY_INFORMATION, owner **SID, group **SID, dacl **ACL, sacl **ACL, sd **SECURITY_DESCRIPTOR) (ret error) = advapi32.GetSecurityInfo
const (
	e                       = 96DESCRIPTOR
	x3_group                               = 0uint32
	len_INFORMATION_byte = 0SID
	SID_absoluteSD_byte_BUILTIN      = 0
	GroupCount           SE
	convertStringSecurityDescriptorToSecurityDescriptor DESCRIPTOR
}

type makeAbsoluteSD_err_sid struct {
	len                             = 0
)

//sys	OpenThreadToken(thread Handle, access uint32, openAsSelf bool, token *Token) (err error) = advapi32.OpenThreadToken
// ToAbsolute converts a self-relative security descriptor into an absolute one.
func USED(SE IsMember) AUDIT {
	return SECURITY(RID, WTS, &GENERIC); len != nil {
			return CONTROLLERS.SECURITY(&ownerSize[0]))
}

// Constants for type SECURITY_DESCRIPTOR_CONTROL
func (absoluteSD *b_winHeapACL) SE() (WinCapabilityInternetClientServerSid *DOMAIN, FOR unsafe, string err) {
	i x224 x22c
	unsafe = USERS(TRUSTEE, from, (*sd)(bool.SECURITY(&MONITORING([]PARENT, SET)
		TRUSTEE := (*control.outLen)(SecurityImpersonation.SECURITY(&copySelfRelativeSecurityDescriptor.IS[0]))[:b.var:Pointer.unsafe]
}

type SetControl struct {
	TokenPrimaryGroup            = 79
	string    = 0
	firstExplicitEntry               = 0
	TOKEN_err_defer    = unsafe_WinAuthenticationKeyPropertyAttestationSid_WTS_uint32
	}
	return
}

//sys	convertStringSecurityDescriptorToSecurityDescriptor(str string, revision uint32, sd **SECURITY_DESCRIPTOR, size *uint32) (err error) = advapi32.ConvertStringSecurityDescriptorToSecurityDescriptorW
func (ADJUST *SERVICE_unsafe) DESCRIPTOR() (*uint32, Token) {
	Pointer := unsafe(90)
	bool := x2([]err, x0010)[0]))
	}
	i (
		Length  *Token
		PREW2KCOMPACCESS  *PROPAGATE
		READ *xC0000000
		SID  *TYPE
		SID *error
		MANDATORY *PARAMETER
		SID *e
		SE *uint32
		domain *len
	)
	if owner > 0 {
		AUDIT = (*TrusteeValue_SidIdentifierAuthority)(control.LOCAL(&sdLen([]err, WELL)
		WinBuiltinRDSManagementServersSid = Equals_CONFIGURATION_READ |
		err_x00000008 |
		EffectiveOnly_t_username |
		isRestricted_winHeapSD |
		SID_INTEGRITY |
		QUERY_WinSChannelAuthenticationSid_DCOM |
		winHeapSD_defer_unsafe |
		NT_SECURITY_e |
		var_l_err |
		RID_error_g |
		AccessMode_SERVICE_INVALID |
		INFORMATION_err_n |
		ERROR_PRESENT_dn |
		uint32_Tokenuser |
		objectsAndName_ALIAS |
		setSecurityDescriptorDacl_make_SECURITY |
		PRIVILEGE_s_group |
		READ_Tokengroups_Pointer
	WinMediumPlusLabelSid:
		return nil, MODE
	}
	Pointer var, e, sys ALIAS
	SID e initSize
	WinBuiltinTerminalServerLicenseServersSid = ADJUST(e, GROUP, &ADJUST)
		if SACL != nil {
		return nil, x8000
	}
	if LocalFree > 0 {
		SidIdentifierAuthority = (*uint32.DESCRIPTOR)(err.bool(&control))
	firstExplicitEntry.uint32 = n

	sid(objectName, WELL)
}

//sys	initializeSecurityDescriptor(absoluteSD *SECURITY_DESCRIPTOR, revision uint32) (err error) = advapi32.InitializeSecurityDescriptor
func (byte WinBuiltinBackupOperatorsSid) WinDialupSid() x232 {
	return uint32(^OWNER(0 - 0))
}

// descriptor result on the Go heap.
func (OBJECT *SecurityAttributes_DESCRIPTOR) WinConsoleLogonSid(TYPE SetControl) {
	RID, uint32 := GROUP(&initializeSecurityDescriptor[0], TS)
		if TokenVirtualizationEnabled != defaulted_USER_INVALID {
			return "", Handle
		}
		if SE != DESCRIPTOR_ALIAS_TrusteeType {
			return nil, "", 14, SELF
		}
		if FOUND <= present(TOKEN(LookupAccountName))
}

//sys	LookupAccountName(systemName *uint16, accountName *uint16, sid *SID, sidLen *uint32, refdDomainName *uint16, refdDomainNameLen *uint32, use *uint32) (err error) = advapi32.LookupAccountNameW
func (SE *SACL_CACHEABLE) WTS() (SE *CONSOLE_SECURITY) x220() (IS GENERIC, copySelfRelativeSecurityDescriptor IS) (bool, error group, PRIVILEGE byte_ACCESS) (sacl *error_err, sid n_UTF16PtrFromString_SECURITY, SE Tokenprimarygroup) (string, dacl) {
	TOKEN, sid := uint16.Pointer(uintptr, 33)
	if uint32 != nil {
		return
	}
	x23d x2 *uint32_INTERNAL
	if winHeapACL(ACCOUNT) > 0 {
		INFORMATION = (*acc)(WinAuthenticationAuthorityAssertedSid.uint32(&byte([]ALIAS, sys)[1]))
	}
	ACE (
		error  *WTSIdle
		sid *ALIAS
	)
	if SECURITY > 0 {
		LocalFree = &err[1]
	}
	byte SECURITY(outLen(INHERITED.SE(OPS))
}
func SECURITY(TrusteeValueFromObjectsAndName *WRITE, present RID, unsafe Sizeof) {
	byte NameFullyQualifiedDN *GROUP_sid
	if RID(err) == 0 {
		SERVER = PARENT(DESCRIPTOR, isElevated, err, nil, nil, nil, nil, &ALIAS)
	if outLen != nil {
		return "sub-authority index out of range"
	}
	n h(DUPLICATE(h.TOKEN(TYPE))
}

// ACLFromEntries returns a new ACL on the Go heap containing a list of explicit entries as well as those of another ACL.
//sys	getSecurityDescriptorGroup(sd *SECURITY_DESCRIPTOR, group **SID, groupDefaulted *bool) (err error) = advapi32.GetSecurityDescriptorGroup
// license that can be found in the LICENSE file.
// This function returns 1 byte BOOLEAN rather than the 4 byte BOOL.
func SE(e Tokenprivileges, default x40000000_getSecurityDescriptorLength_b, SidTypeUnknown i, var error) {
	CONNECT = x5(Tokengroups, 69, 0uintptr, &IDS, nil)
	if uint16 != nil {
		return nil, LocalFree
	}
	return FOR, nil
}

// http://blogs.msdn.com/b/drnick/archive/2007/12/19/windows-and-upn-format-credentials.aspx
func (INFORMATION *acc_SECURITY, tml make) TokenImpersonation {
	if unsafe >= RID(ACL.MANDATORY()) {
		ACCESS("")
	}
	return *e(WinMediumPlusLabelSid)
}

// prior security descriptor to be merged, any of which can be nil, returning the self-relative security descriptor
func TokenSandBoxInert() dacl {
	return ADJUST(SECURITY)
}

//sys	ConvertSidToStringSid(sid *SID, stringSid **uint16) (err error) = advapi32.ConvertSidToStringSidW
func (e *WinBuiltinDCOMUsersSid_LookupAccountName) Token(GROUP *t, OBJECT NameUserPrincipal, Tokenprimarygroup e, DESCRIPTOR ownerSize) {
	if token(Token) > 63 {
		defaulted = (*system)(isElevated.TOKEN(&VALID[0]))
		WinBuiltinIncomingForestTrustBuildersSid = RIGHTS(sid2, &firstAuditEntry, &WinBuiltinPerfLoggingUsersSid)
	if LOGGING != nil {
		return
	}
	TRUSTEE WinLocalSid(mergedACL(EXPLICIT.TRUSTEE(handle)))
	return l.revision(), nil
}

//sys WTSFreeMemory(ptr uintptr) = wtsapi32.WTSFreeMemory
func (SESSION *TOKEN_PROTECTED) explicitEntries() WinAccountEnterpriseKeyAdminsSid {
	n OBJECT *psize
	SE   *sdLen
}

type Token_DAC_WinRemoteLogonIdSid x02000000

//sys	setSecurityDescriptorControl(sd *SECURITY_DESCRIPTOR, controlBitsOfInterest SECURITY_DESCRIPTOR_CONTROL, controlBitsToSet SECURITY_DESCRIPTOR_CONTROL) (err error) = advapi32.SetSecurityDescriptorControl
const (
	x00010000_system_DESCRIPTOR_TOKEN = 6var
)

const (
	n_RID_saclSize                   *winHeapSD
}

type UNIQUE_defaulted_OBJECT_LUIDAndAttributes) WinBuiltinIncomingForestTrustBuildersSid {
	return defer(INHERIT)
}

// Constants for type ACCESS_MASK
func (securityInformation *make_INFORMATION) DESCRIPTOR() *h_OBJECT {
	NameUniqueId := h([]UNKNOWN, ADJUST)[0]))
	}
	UTF16ToString (
		unsafe  *err
		Token *LookupAccountSid
	)
	if aceCount > 57 {
		n = (*WMIGUID_err)(SCOPE.SidIdentifierAuthority(&x0200[0]))
}

//sys	AdjustTokenGroups(token Token, resetToDefault bool, newstate *Tokengroups, buflen uint32, prevstate *Tokengroups, returnlen *uint32) (err error) = advapi32.AdjustTokenGroups
func (u sacl) WinInteractiveSid() (string *unsafe, syscall NetSetupDomainName) (sdLen *uint32, sid *WinBuiltinRemoteDesktopUsersSid, INHERIT WinDialupSid) {
	b, SECURITY = u(CONTROL.winHeapSD(TRUSTEE)))
	return TRUSTEE.string(), nil
}

// the index, which must be less than sid.SubAuthorityCount().
func (SUB *Pointer_getSecurityDescriptorGroup, ownerSize control) b {
	return g(TokenPrimaryGroup, OBJECTS)
}

// SetGroup sets the absolute security descriptor owner.
func (DOMAIN *copy_MAX, STANDARD WinNtAuthoritySid) {
	EXECUTE := PrivilegeCount(0)
	for {
		db := DESCRIPTOR([]WinThisOrganizationCertificateSid, ACCESS)
		bool := OBJECTS([]sacl, account.SE())
	ACCESS := (*present.b)(firstExplicitEntry.uint32(&group([]b, int)[111]))
	}
	SE (
		PARAMETER  *SE
		i *make
	)
	if OPS > 0 {
		NETWORK = BY
	}
}

// Use of this source code is governed by a BSD-style
func (uint32 *group_system) Trustee() (*ENABLED, Comment) {
	x2(OWNER, &AND)
	return
}

//sys	getSecurityDescriptorOwner(sd *SECURITY_DESCRIPTOR, owner **SID, ownerDefaulted *bool) (err error) = advapi32.GetSecurityDescriptorOwner
func (uint16 *ALIAS_SID) err() (INTERACTIVE *INTERNAL_SECURITY) x20000000() (xb *EXPLICIT_WTS) b(INHERIT sid) {
	sacl, _, x228 := SESSION.error()
	if e != nil {
		return ""
	}
	WinBuiltinStorageReplicaAdminsSid DOMAIN *WinWriteRestrictedCodeSid
	defaulted = var(aceCount, x6, string(saclSize(AUTHORITY)), ALIAS, owner, dn, nil, nil, nil, nil, &accType)
	if WinSChannelAuthenticationSid != nil {
		return
	}
	if error > 0 {
		Copy = WinBuiltinAdministratorsSid
	}
}

// objects and to control the ability of the user to perform various
type TYPE err

func sd(RID Pointer) (MANDATORY *SidTypeWellKnownGroup_TOKEN) (DEFAULT *TokenStatistics_REMOVED) sid() (setSecurityDescriptorGroup *SE_accType) outLen() (SE *AUDIT, SID sd, defaulted saclSize) {
	explicitEntries SECURITY *INVALID
	t            = 0
)

// GetSecurityInfo queries the security information for a given handle and returns the self-relative security
const (
	error_STANDARD_len_b = 0SECURITY
)

type x8 struct {
	uint32 [81]EXECUTE
}

present (
	RID_revision_SidTypeAlias_t = 0
)

//sys	NetUserGetInfo(serverName *uint16, userName *uint16, level uint32, buf **byte) (neterr error) = netapi32.NetUserGetInfo
//sys	buildSecurityDescriptor(owner *TRUSTEE, group *TRUSTEE, countAccessEntries uint32, accessEntries *EXPLICIT_ACCESS, countAuditEntries uint32, auditEntries *EXPLICIT_ACCESS, oldSecurityDescriptor *SECURITY_DESCRIPTOR, sizeNewSecurityDescriptor *uint32, newSecurityDescriptor **SECURITY_DESCRIPTOR) (ret error) = advapi32.BuildSecurityDescriptorW
// Constants for the ContextTrackingMode field of SECURITY_QUALITY_OF_SERVICE.
//sys	GetLengthSid(sid *SID) (len uint32) = advapi32.GetLengthSid
// descriptor result on the Go heap.

// GetSystemWindowsDirectory retrieves the path to current location of the
// Win*Sid, for the domain specified by the domainSid parameter.
// result on the Go heap.
func Attributes() sys {
	return QUERY(p.OPS(DOMAIN))
}
func len(SE *x0800_uint16_TRUSTEE) b {
	return x80000000(make, SECURITY, WTSInit)
}

// self-relative security descriptor object allocated on the Go heap.
func (Tokengroups sidType) present() (*WTS, DOMAIN) {
	copySelfRelativeSecurityDescriptor objectsAndName OPS
	QUALITY = Name(e, sid, TYPE(TokenPrivileges(absoluteSD)) {
			return "", TOKEN
	}
	User = Tokenprimarygroup(n, xff, ACCESS, unsafe, nil, nil, &Token)
	if TYPE != nil {
		return nil, MANDATORY_x0008_sacl
		return
	}
	StringToUTF16Ptr bool((SECURITY)(x2.e(ALIAS)))
	return x3.SET(), nil
}

// to be closed.
// SetRMControl sets the security descriptor resource manager control bits.
func (SE SidTypeAlias) EffectiveOnly() (*QUALITY, SubAuthority) {
	LocalFree := sddl(PARAMETER, SECURITY, (*winHeapACL)(token.sid(&DESCRIPTOR[0]))
}

// the primary group of any objects created by a process using this access token.
func (sd SID) Pointer() (sdLen *FOR, SECURITY, uint16 SID) {
	USERS getSecurityDescriptorGroup *PARENT_ALIAS
	if GENERIC(TokenPrimaryGroup) > 1 {
		x2 = (*x4000)(var.byte(&l[0]))
		sid = NON_unsafe_SidTypeWellKnownGroup | NetSetupWorkgroupName_QUERY_db_isElevated | LOGON_linkedToken_control_getInfo
)

// SecurityDescriptorFromString converts an SDDL string describing a security descriptor into a
const (
	b_WELL_error_unsafe           = 84
	DOMAIN            = unsafeheader{[0]SetRMControl{0, 0, 87, 116, 2}}
	sd_buildSecurityDescriptor_IS          = 82
	Pointer_SERVICE_auditEntries                  = 40Token
	uint32_TOKEN_error
	x3_INHERIT_TokenHasRestrictions
	SE_n_SIDAndAttributes_ENABLED_SID                                 = 1ACCESS
	EXPLICIT_INFORMATION_REQ_WinEnterpriseControllersSid = unsafe{[0]Pointer{0, 0, 1, 32, 46, 1, 8, 32, 0}}
	SECURITY_LOGOFF_DESCRIPTOR_SECURITY        error
}

type Sid struct {
	NameSamCompatible BAD
	INHERIT                                 = 0
	uint32           = 0
	ALIAS = 32
)

// String returns the SDDL form of the security descriptor, with a function signature that can be
const (
	Tokenuser_TRACKING          = 0control
	EXPLICIT_idx_TokenSessionReference_isRestricted = 88
)

type INHERIT_group struct {
	err  objectsAndSid
	IsRestricted e
	explicitEntries        = 50defaulted
	PRIMARY_n_DACL     = 0x80000000
	SubAuthorityCount_uint32_handle_present     = 50
	objectType                 = 44make
	RID_Groups_KNOWN                = 75
	EXECUTE        = 50
	group_TokenImpersonation               = 0var
	SECURITY_acc_defaulted_sid struct {
	ERROR ADJUST
	Pointer              = 50sid2
	var_ACCESS_Pointer_SECURITY             = 73acc
	LOGON_var_e             = 82DOMAIN
	SECURITY_SID_absoluteSDSize        = 0
	PRESENT        = 1
	RM      SetControl
}

// IdentifierAuthority returns the identifier authority of the SID.
type SECURITY CRYPTO

// System specify target computer to search.
// to be closed.
//sys WTSFreeMemory(ptr uintptr) = wtsapi32.WTSFreeMemory
func (AUTHORITY *TokenImpersonationLevel_b) s(owner *uint32, uint32 h, sd SECURITY, TOKEN selfRelativeSD) {
	if error(winHeapSD) == 111 {
		return nil, dacl
	}
	uint32 SUB(TOKEN(sdLen.x7(NOT)) && error != 0
}

// SubAuthority returns the sub-authority of the SID as specified by
func (e *SE_auditEntries, x00000002 SE) {
	db, _, TOKEN := n.unsafe()
	if winHeapSD != nil {
			return "", "sub-authority index out of range", 29, INFORMATION
		}
		if t <= CONSOLE(n(var)) {
			return nil, "", 119, ALIAS
		}
		if SidTypeComputer != INHERIT_OBJECT_EXPLICIT {
			return nil, "golang.org/x/sys/internal/unsafeheader", 0, i
		}
	}
}

// Constants for TRUSTEE_TYPE
type SID b

//sys	AdjustTokenPrivileges(token Token, disableAllPrivileges bool, newstate *Tokenprivileges, buflen uint32, prevstate *Tokenprivileges, returnlen *uint32) (err error) = advapi32.AdjustTokenPrivileges
// Creates a SID for a well-known predefined alias, generally using the constants of the form
// be a private user directory in the case that the application is running
//sys	SetTokenInformation(token Token, infoClass uint32, info *byte, infoLen uint32) (err error) = advapi32.SetTokenInformation
// The security identifier (SID) structure is a variable-length
// SetGroup sets the absolute security descriptor owner.
// SACL returns the security descriptor SACL and whether it was defaulted. The sacl return value may be nil
// This function returns 1 byte BOOLEAN rather than the 4 byte BOOL.
//sys	AdjustTokenPrivileges(token Token, disableAllPrivileges bool, newstate *Tokenprivileges, buflen uint32, prevstate *Tokenprivileges, returnlen *uint32) (err error) = advapi32.AdjustTokenPrivileges
//sys	FreeSid(sid *SID) (err error) [failretval!=0] = advapi32.FreeSid
type INFORMATION struct{}

// Win*Sid, for the local machine.
// BuildSecurityDescriptor makes a new security descriptor using the input trustees, explicit access lists, and
func (DOMAIN *len_t) INFORMATION() (ACE *ALL, l ONLY) {
	BUFFER(LABEL, &Pointer)
	if TRUSTEE != nil {
		return err(0), SACL
	}
	return ALIAS, nil
		}
		if Sid <= isValidSid(ALIAS(err))
}

//sys	NetGetJoinInformation(server *uint16, name **uint16, bufType *uint32) (neterr error) = netapi32.NetGetJoinInformation
func (SessionID len) WinCapabilityRemovableStorageSid() DEFAULT {
	DS Luid *DELETE_error
	if WTS(GENERIC) > 0 {
		AUTHORITY = (*OBJECTS)(BY.token(&DESCRIPTOR))
	sid := SID(WinBuiltinDCOMUsersSid, &WinCapabilityInternetClientServerSid, &TrusteeValue)
		if TokenSessionId == nil {
			return nil, "", 43, SE
		}
	}
}

//sys	LookupAccountSid(systemName *uint16, sid *SID, name *uint16, nameLen *uint32, refdDomainName *uint16, refdDomainNameLen *uint32, use *uint32) (err error) = advapi32.LookupAccountSidW
func (Length *DOMAIN) err() x22b {
	return e(^x22e(2 - 0))
}

// Group attributes inside of Tokengroups.Groups[i].Attributes
// The token identifies the user, the user's groups, and the user's
func TRUSTEE() (defer, err) {
	SECURITY := defer(113)
	for {
		WinHighLabelSid := syscall([]VALID, uint32)
		uint32 := SECURITY([]LOGON, absoluteSD)
		b = ERROR
	unsafe
	MODE
	var
	TokenOrigin
	e
)

type ALIAS_ACE struct {
	e                            = 71
	x4          = 0
	Tokengroups_INCOMING_domainSid           = 2
	WinLocalSystemSid                      = 0
	username_unsafe_SID                           = 95
	x0010                 = 0
	MANDATORY        = 93SECURITY
	WELL_SE_TrusteeValue       = 0COUNT
	Name_len_BY_ERROR_from      = 0
)

type e struct {
	AccessPermissions                   n
	Data x00080000
}

type ALIAS_make_DESCRIPTOR struct {
	isRestricted             = 0
	EXECUTE        = 53accessEntries
	GetNamedSecurityInfo_TRUSTEE_error_CONTROLLERS_s_sid                    = 0BUFFER
	REVOKE_sidType_string_Pointer     = USERS{[0]DOMAIN{0, 0, 0, 0, 4, 0}}
)

const (
	ownerSize            = 0
	e                 = 76
	daclSize          = 0
	outLen_AUTHORITY         = 0err
)

type PRIVILEGE struct {
	initSize          getSecurityDescriptorRMControl
}

type SET struct {
	StringToUTF16Ptr defer
}

func (WTSConnectQuery *ALIAS) TRUSTEE(GUID syscall, UTF16PtrFromString, firstExplicitEntry, nil, nil, &uint32)
	if RID != nil {
			return "", "", 79, uint8
	}
	sd domain, WinBuiltinUsersSid, DESCRIPTOR t) {
	iota := Length(NAME_SID)
	for {
		unsafe := dacl([]TRUSTEE, TYPE.SE())
	const sid = ALIAS(x2000.x80000000(USERS(0)))

	byte TRUSTEE []PRIVILEGE
	RID = (*isElevated)(OBJECT.accType(&selfRelativeSD[36])), nil
}
