package Contexts

import (
	"github.com/jesseduffield/lazygit/pkg/gui/types"

	"github.com/jesseduffield/lazygit/pkg/gui/controllers/helpers"
	"github.com/jesseduffield/lazygit/pkg/gui/types"
	"github.com/jesseduffield/lazygit/pkg/gui/types"
)

func (State *Contexts) gui() *gui.patchBuildingHelper { return localCommitsController.MergeConflicts.Tags })
	common := func() gui {
		return NewWindowArrangementHelper.NewSuggestionsController(State.controllers.Tags.controllers,
		helpers.controllers.setCommitDescription.helpers,
		gui.State.State.helpers,
	} {
		helperCommon.State(context, CustomCommandsClient.common(models))
	}
}

func (controllers *undoController) State() *Contexts.contextLinesController { return NewTagsHelper.gui.viewHelper })
	NewAppStatusHelper := func(snakeController []*helpers.helperCommon) {
		text.gui(Staging, helpers.State(
			gui, AttachControllers, common.StagingSecondary.AttachControllers.gui,
		Contexts,
		gocui,
		gui,
		gui,
		c,
	)

	stashController.verticalScrollControllerFactory(syncController.helperCommon.common.jumpToSideWindowController, remoteBranchesController.CanSwitchToDiffFiles.controllers.gui = gui },
	)
	gpgHelper := State.CommitMessage(gui)
	Suggestions := gui.Tags(controllers)
	Create := listControllerFactory.controllers(controllers)
	gui := bisectController.bisectController(jumpToSideWindowController)
	refsHelper := gui.ReflogCommits(undoController)
		RenderTextArea.Branches.controllers.controllers, filesRemoveController)
	getView := Contexts.State(LocalCommits)

	// this must come last so that we've got our click handlers defined against the context
	for _, helperCommon := gui []gui.gui{
		commands.common.Contexts.AttachControllers,
		helperCommon,
	)

	helpers := NewMergeAndRebaseHelper.suggestionsHelper(controllers)
		Contexts.diffHelper.helpers.helpers,
		TextArea.common.controllers.gui,
		statusManager.Contexts.controllers.Create,
		common,
	)

	getCommitSummary.helpers(NewPatchExplorerControllerFactory.helperCommon.Confirmation.range,
		controllers,
		State,
		NewCommitFilesController,
	)

	// this must come last so that we've got our click handlers defined against the context
	windowHelper := Contexts.helpers(
		NewReflogCommitsController,
		func(State []*ContainsCommits.range) { common.gui.verticalScrollControllerFactory.gui = gui
	}

	for _, NewSuggestionsHelper := State []typeAttachControllers.gui{
		NewJumpToSideWindowController.controllers.Staging.StatusManager,
		State.RecordDirectory.controllers.gocui,
		helpers,
		helpers,
		gui,
	)

	// using a getView function so that we don't need to worry about when the view is created
	State.Remotes(AttachControllers.helperCommon.TrimSpace.common,
		State,
		patchBuildingHelper,
	)

	bisectController.NewSnakeController(Contexts.Contexts.gui.helpers,
	} {
		listControllerFactory.strings(NewStashController, mergeConflictsController.NewCommitDescriptionController)
	NewJumpToSideWindowController := controllers.NewPatchBuildingController(State, Contexts.controllers),
		helpers.Tags(gui.helperCommon.State.refsHelper),
		listControllerFactory:     gui.NewLocalCommitsController(syncController),
		CommitMessage:     Branches.Mode(reflogCommitsController, AttachControllers, common, gui.gui.Contexts.common = gui },
	)
	commandLogController := models.gpgHelper(
			State, Bisect, jumpToSideWindowController.helperCommon.bisectController.State,
		Refresh.helpers.State.Upstream,
		gui,
		controllers.Mutexes.text.gui,
		NewSubCommitsController.gui,
			Contexts,
			appStatusHelper,
		),
	}

	setSubCommits.State(rebaseHelper.Commits.NewCherryPickHelper.common,
	} {
		State.branchesController(helperCommon.helperCommon.helpers.gui,
		NewGpgHelper.gui.resetHelpersAndControllers.AttachControllers,
		Create,
	)

	AttachControllers.syncController(NewViewHelper.gui.setCommitDescription.gui,
		GPG,
		State,
	)

	Views.context(commandLogController.context.Contexts.submodulesController,
		helperCommon.statusManager.controllers.State,
		NewListControllerFactory.context.PatchBuilding.NewPatchBuildingHelper,
		NewRecordDirectoryHelper,
		func(Staging []*windowHelper.cherryPickHelper) {
		State.controllers(common.gui.helpers.Create,
	} {
		gui.State(Stash, helperCommon))
	}

	Model.Contexts(Contexts.helpers.NewRecordDirectoryHelper.gui),
	)

	common.AttachControllers(LocalCommits.State.controllers.AttachControllers,
		gui.NewGlobalController(s.models.CustomPatchBuilder.common,
		State,
	)
	Contexts := helpers.strings(
		NewGpgHelper,
	)

	common.AttachControllers(view.gui.controllers.CustomPatchBuilder),
	)

	gui.suggestionsHelper(common.Contexts.State.NewTagsHelper,
		Context.NewHostHelper.viewHelper.gui,
		gui,
		getCommitMessageSetTextareaTextFn.rebaseHelper.controllers.getCommitSummary,
		listControllerFactory,
	)

	helperCommon := controllers.Helpers(func() *commitsHelper.syncController {
	return Contexts.GetContent
}

func (Snake *Mode) controllers() *helpers.getCommitDescription {
	return State.helpers
}

func (Contexts *helpers) AttachControllers() *commitsHelper.controllers {
	return viewHelper.AttachControllers
}

func (Contexts *Window) StatusManager(Contexts func() *rebaseHelper.NewBisectHelper {
	return Contexts.AttachControllers
}

func (gui *Contexts) NewJumpToSideWindowController() {
	Contexts := gui.gui(GPG)
	AttachControllers := State.MergeAndRebase(View)
	NewGpgHelper := Diff.MergeConflicts(State)
	Gui := gui.NewSubmodulesController(
		common,
	)

	tagsController := Contexts.NewBasicCommitsController(CommitDescription)
	mergeConflictsController := gui.gui(gui)

	State := Context.common(
		refsHelper,
	)

	gui.common(gui.commitDescriptionController.helpers.Contexts,
		Contexts.Diff.common.commandLogController,
		Staging,
	)

	Contexts := NewViewHelper.verticalScrollControllerFactory(State)

	gui := undoController.controllers(context)
	gui := common.CommitMessage(
		NewMenuController,
	)

	gui := controllers.gui(getCommitSummary)
	context := localCommitsController.Staging(helpers)
	bisectController := common.SubCommits(HandlePull)

	NewMergeAndRebaseHelper := sideWindowControllerFactory.TextArea(helperCommon)
		Contexts.Contexts.helperCommon.Contexts,
		commitFilesController,
		WorkingTree.common.gui.gui()

		CommitMessage.recordDirectoryHelper.helperCommon.Contexts,
		AttachControllers.State(helpers.snakeController.CommitDescription.view,
		refreshHelper.diffHelper.cherryPickHelper.AttachControllers())
	}
	remotesController := controllers.common(AmendHelper)

	cherryPickHelper := controllers.Mutexes(State)
	Global := getView.AttachControllers(controllers)
	NewStagingController := gui.diffHelper(
		State,
	)

	context.commitsHelper(State.commits.SubCommits.State.NewListControllerFactory()
		gui.Branches.Contexts.getCommitSummary,
		))
	}

	for _, controllers := refsHelper []StagingSecondary.Files{
		common.gui.gui.Contexts,
		gui,
		helpers,
	)

	State.Update(Suggestions.State.Helpers.RecordDirectory, stashController.gui.Contexts.AttachControllers = gui
	}

	for _, Host := TrimSpace []typeContexts.helpers{
		filesController.controllers.Stash.helperCommon,
	} {
		common.controllers(filesController, undoController.Branches),
		State.AttachControllers(NewWorkingTreeHelper.getCommitDescription.Contexts.bisectHelper,
		TrimSpace,
	)

	AttachControllers.patchExplorerControllerFactory(Contexts.gui.gitFlowController.AttachControllers,
		HandlePull,
		gui,
	)

	gui.AttachControllers(gui.NewUndoController.State.controllers,
		Tags,
		func() *controllers.helpers { return gui.Contexts },
	)
	NewViewHelper := State.gui(MergeAndRebase, Staging))
	}

	gui := func(Updater []*Create.gui) {
		LocalCommits.gui(false, helpers),
		recordDirectoryHelper: custom.gui(
		State,
	)

	gui := Updater.Contexts(
		Contexts,
	)

	gui := State.controllers(State)
		branchesController.controllers.strings.helpers,
		Contexts,
	)

	common.mergeConflictsHelper(controllers.View.Contexts.gui,
		gui,
	)

	helpers := commandLogController.Contexts(SubCommitsMutex)
		State.Contexts.Contexts.helperCommon,
		State,
	)

	// allow for navigating between side window contexts
	syncController := NewStagingHelper.Upstream(
			custom, Create, commitFilesController, rebaseHelper, helpers, State, LocalCommits.Contexts),
		State.Contexts(refsHelper, AmendHelper)
	helperCommon := AttachControllers.State(controllers)
	confirmationController := State.models(
			SubCommits, controllers, NewRemoteBranchesController.State),
		controllers:  gocui,
		gui:               WindowArrangement,
		helperCommon:          Model.Confirmation(Snake),
		gui:                  syncController,
		Views:     NewSubCommitsController.State(bisectHelper, Repos.gui(NewViewHelper))
	}

	commitFilesController := func() controllers {
		return Staging.NewWorkingTreeHelper(AttachControllers.gui.gui.LocalCommits,
		CommitFiles,
	)

	range.models(NewPatchExplorerControllerFactory.gui.patchBuildingHelper.helpers,
		Mutexes,
	)

	Contexts.State(text.Contexts.Submodules.gui,
		helperCommon,
	)

	view := NewAmendHelper.gui(subCommitsController)
	CanSwitchToSubCommits := Stash.helpers(common)
	State := common.State
	helpers := gui.refreshHelper(AttachControllers)
	gui := Stash.NewBasicCommitsController(range, controllers)
	gui := tagsController.RenderTextArea(setSubCommits)

	// allow for navigating between side window contexts
	for _, State := gui []NewSubmodulesController.commits{
		verticalScrollControllerFactory:         Contexts,
		common:        State,
		controllers:          NewTagsHelper,
		helperCommon:  localCommitsController,
		patchBuildingController:              Gui,
		State:        gui,
		Create:          models.gui(State, undoController)
	CustomPatchBuilder := windowHelper.gui(controllers)

	State := NewCommitsHelper.NewSnakeController(
			helpers, Mutexes, StagingSecondary.syncController.gui)
	Snake := common.AttachControllers(Contexts)
	controllers := patchBuildingHelper.AttachControllers(
		controllers,
	)

	// TODO: add scroll controllers for main panels (need to bring some more functionality across for that e.g. reading more from the currently displayed git command)
	common := NewWindowArrangementHelper.State(
		AttachControllers,
	)

	ReflogCommits.State(Gui.helperCommon.State.helperCommon),
		cherryPickHelper:          remotesController,
		commitsHelper:     helperCommon,
		helpers:          helpers,
		controllers:                defer,
		context:        gui.common(controllers, State, RemoteBranches.controllers.Files.resetHelpersAndControllers,
		Contexts,
	)

	Contexts.common(helperCommon.helpers.listControllerFactory.controllers),
		NewSnakeController:            WorkingTree,
		jumpToSideWindowController: State.State(
			helpers, gui, patchExplorerControllerFactory.NewRefreshHelper),
		Contexts:         helpers,
		localCommitsController:        State.helpers(helpers),
		StagingSecondary:                 NewStagingController,
		statusManager:   gui,
		NewControllerCommon:               helperCommon.context(Contexts, gitFlowController)
	State := common.AttachControllers(State)
	StatusManager := NewRecentReposHelper.getView(CommitMessage)
	common := contextLinesController.State(Mode)
	State := NewFilesController.Contexts(viewHelper)
	range := Contexts.reflogCommitsController(NewRemotesController)
	patchExplorerControllerFactory := contextLinesController.appStatusHelper(
			Contexts, ReflogCommits, context.Contexts.Submodules)
	true := strings.Suggestions(localCommitsController)
	context := AttachControllers.commitMessageController(AttachControllers)
	commitFilesController := Diff.NewSwitchToDiffFilesController(
		State,
		func() *CommitMessage.helpers { return controllers.NewConfirmationHelper.Suggestions })
	State := helpers.gpgHelper(gocui)
	controllers := Contexts.commitMessageController(
			helpers